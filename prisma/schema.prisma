generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int      @id @default(autoincrement())
  username  String   @unique
  email     String   @unique
  hash      String
  salt      String
  elo       Int      @default(500)
  puzElo    Int      @default(500)
  createdAt DateTime @default(now())
  wins      Int      @default(0)
  losses    Int      @default(0)
  draws     Int      @default(0)

  // Relationships
  whiteGames Game[] @relation("WhitePlayer")
  blackGames Game[] @relation("BlackPlayer")
}

model Game {
  id         String   @id
  whiteId    Int
  blackId    Int
  white      User     @relation("WhitePlayer", fields: [whiteId], references: [id])
  black      User     @relation("BlackPlayer", fields: [blackId], references: [id])
  fen        String
  moves      String   // Store as JSON string
  turn       String   @default("w")
  whiteTime  Int
  blackTime  Int
  startTime  DateTime @default(now())
  lastUpdate DateTime @updatedAt
  timeControl String?
}

model Puzzle {
  id      String @id
  fen     String
  solution String
  rating   Int
  themes   String
}
